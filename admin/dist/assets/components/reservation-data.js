import{deleteReservation}from"../../api/reservation";import{fetchRooms,updateRoomData}from"../../api/room";class ReservationData extends HTMLElement{connectedCallback(){const e=this.getAttribute("roomInfo"),{_id:t,roomType:o="N/A",checkIn:s="N/A",checkOut:n="N/A",added:r="N/A"}=e?JSON.parse(e):{},a=this.getAttribute("customerInfo"),{username:i="Guest",gender:c="N/A",phone:m="N/A",city:d="N/A",country:l="N/A",roomPrice:h="N/A"}=a?JSON.parse(a):{};this.innerHTML=`\n      <div class="bg-white p-5 shadow-md rounded-md">\n        <h3 class="font-semibold text-lg">${i}</h3>\n        <p class="text-sm text-gray-600 mt-1">Room: ${o}</p>\n        <p class="text-sm text-gray-600">Check-in: ${s}</p>\n        <p class="text-sm text-gray-600">Check-out: ${n}</p>\n        <p class="text-sm text-gray-600">Added: ${r}</p>\n\n        <div class="mt-4 flex justify-end gap-2">\n          <button class="confirm-btn bg-[#7C6A46] hover:brightness-110 text-white text-sm px-3 py-1 rounded">Confirm</button>\n        </div>\n      </div>\n    `,this.querySelector(".confirm-btn").addEventListener("click",(async()=>{const e=(await fetchRooms()).data.rooms;try{const s=e.filter((e=>!e.isBooked&&e.roomType!==o));if(s.length>0){const e=s[Math.floor(Math.random()*s.length)].roomNo,n={customer:i,roomType:o,roomPrice:h,isBooked:!0};console.log(n),console.log(e),console.log("_ID",t),await updateRoomData(n,e),console.log(`Admin: Room ${e} assigned to customer ${i}.`),"success"===(await deleteReservation(t)).status&&this.remove()}else console.log("Admin: No suitable empty rooms available for this customer request. Showing modal.")}catch(e){console.error("Admin: Error during room assignment process:",e)}}))}}customElements.define("reservation-data",ReservationData);